<?xml version="1.0" encoding="utf-8"?>
<manifest>
  <control 
    namespace="YBEnhancedComments" 
    constructor="EnhancedCommentTimeline" 
    version="2.1.1" 
    display-name-key="EnhancedCommentTimeline" 
    description-key="Timeline de comentarios de SharePoint - Desarrollado por Yoany Bermudez" 
    control-type="standard"
  >
    <!--external-service-usage node declares whether this 3rd party PCF control is using external service or not, if yes, this control will be considered as premium and please also add the external domain it is using.
    If it is not using any external service, please set the enabled="false" and DO NOT add any domain below. The "enabled" will be false by default.
    Example1:
      <external-service-usage enabled="true">
        <domain>www.Microsoft.com</domain>
      </external-service-usage>
    Example2:
      <external-service-usage enabled="false">
      </external-service-usage>
    -->
    <external-service-usage enabled="false">
      <!--UNCOMMENT TO ADD EXTERNAL DOMAINS
      <domain></domain>
      <domain></domain>
      -->
    </external-service-usage>
    <!-- Propiedades de entrada y salida -->
    <property name="CommentsJSON" display-name-key="CommentsJSON_Disp" description-key="JSON de comentarios de SharePoint (entrada)" of-type="Multiple" usage="input" required="false" />
    <property name="IsLoading" display-name-key="IsLoading_Disp" description-key="Indica si el componente está cargando datos" of-type="TwoOptions" usage="input" required="false" />

    <!-- Entradas adicionales para ejecución de Flow y correlación -->
    <property name="SiteUrl" display-name-key="SiteUrl_Disp" description-key="URL del sitio de SharePoint" of-type="SingleLine.Text" usage="input" required="false" />
    <property name="RecordId" display-name-key="RecordId_Disp" description-key="Identificador del registro (texto o número)" of-type="SingleLine.Text" usage="input" required="false" />
    <property name="FlowReturnIn" display-name-key="FlowReturnIn_Disp" description-key="Retorno autocontenido del Flow (JSON con operationId, error, payload)" of-type="Multiple" usage="input" required="false" />

    <!-- Compatibilidad hacia atrás: salidas existentes -->
    <property name="NewCommentText" display-name-key="NewCommentText_Disp" description-key="Texto del nuevo comentario (salida)" of-type="SingleLine.TextArea" usage="output" required="true" />
    <property name="NewCommentTrigger" display-name-key="NewCommentTrigger_Disp" description-key="Trigger para detectar nuevos comentarios (incrementa cada vez)" of-type="Whole.None" usage="output" required="true" />

    <!-- Nuevas salidas para contrato simplificado -->
    <property name="OperationIdOut" display-name-key="OperationIdOut_Disp" description-key="GUID de correlación por intento" of-type="SingleLine.Text" usage="output" required="false" />
    <property name="RequestPayloadOut" display-name-key="RequestPayloadOut_Disp" description-key="Payload de solicitud para Flow (JSON)" of-type="Multiple" usage="output" required="false" />
    <property name="CommentsJSONOut" display-name-key="CommentsJSONOut_Disp" description-key="Timeline actualizado tras optimista/normalización/rollback (JSON)" of-type="Multiple" usage="output" required="false" />
    <property name="IsBusyOut" display-name-key="IsBusyOut_Disp" description-key="Estado de operación en curso" of-type="TwoOptions" usage="output" required="false" />
    <property name="LastError" display-name-key="LastError_Disp" description-key="Mensaje de error" of-type="SingleLine.Text" usage="output" required="false" />

    <resources>
      <code path="index.ts" order="1" />
      <resx path="strings/CommentTimeline.1033.resx" version="1.0.0" />
      <css path="css/CommentTimeline.css" order="1" />
    </resources>
    

    <!-- UNCOMMENT TO ENABLE THE SPECIFIED API
    <feature-usage>
      <uses-feature name="Device.captureAudio" required="true" />
      <uses-feature name="Device.captureImage" required="true" />
      <uses-feature name="Device.captureVideo" required="true" />
      <uses-feature name="Device.getBarcodeValue" required="true" />
      <uses-feature name="Device.getCurrentPosition" required="true" />
      <uses-feature name="Device.pickFile" required="true" />
      <uses-feature name="Utility" required="true" />
      <uses-feature name="WebAPI" required="true" />
    </feature-usage>
    -->
  </control>
</manifest>